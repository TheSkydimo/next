(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[308],{9580:function(e,t,n){Promise.resolve().then(n.bind(n,7718))},7718:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return u}});var r=n(7437),a=n(2265),s=n(7138),i=n(6463),l=n(7668);function u(){let e=(0,i.useRouter)(),[t,n]=(0,a.useState)(""),[u,o]=(0,a.useState)(""),[d,c]=(0,a.useState)(!1),[p,h]=(0,a.useState)(""),[f,g]=(0,a.useState)(""),[y,x]=(0,a.useState)(!1),[m,j]=(0,a.useState)(null),[S,v]=(0,a.useState)(null);function b(){h((0,l.y)()),g("")}async function w(n){if(n.preventDefault(),j(null),v(null),f.trim().toUpperCase()!==p.toUpperCase()){j("验证码错误"),b();return}x(!0);try{var r,a;let n=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:u})}),s=await n.json();if(!n.ok||"OK"!==s.code){j(null!==(a=s.message)&&void 0!==a?a:"登录失败");return}if((null===(r=s.data)||void 0===r?void 0:r.role)==="ADMIN"){j("该账号为管理员账号，请使用 /admin/login 入口登录后台");return}v("登录成功"),e.push("/account")}catch(e){j("网络错误，请稍后重试")}finally{x(!1)}}return(0,a.useEffect)(()=>{b()},[]),(0,r.jsxs)("main",{style:{maxWidth:400,margin:"40px auto",padding:"0 16px"},children:[(0,r.jsx)("h1",{children:"登录"}),(0,r.jsxs)("form",{onSubmit:w,style:{display:"grid",gap:12,marginTop:16},children:[(0,r.jsxs)("label",{style:{display:"grid",gap:4},children:[(0,r.jsx)("span",{children:"邮箱"}),(0,r.jsx)("input",{type:"email",value:t,onChange:e=>n(e.target.value),required:!0})]}),(0,r.jsxs)("label",{style:{display:"grid",gap:4},children:[(0,r.jsx)("span",{children:"密码"}),(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:8,alignItems:"center"},children:[(0,r.jsx)("input",{type:d?"text":"password",value:u,onChange:e=>o(e.target.value),required:!0,style:{width:"100%"}}),(0,r.jsx)("button",{type:"button",onClick:()=>c(e=>!e),style:{fontSize:12,padding:"4px 8px",whiteSpace:"nowrap"},children:d?"隐藏密码":"显示密码"})]})]}),(0,r.jsxs)("label",{style:{display:"grid",gap:4},children:[(0,r.jsx)("span",{children:"验证码"}),(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:8,alignItems:"center"},children:[(0,r.jsx)("input",{value:f,onChange:e=>g(e.target.value),required:!0,placeholder:"请输入右侧验证码",style:{width:"100%"}}),(0,r.jsx)("button",{type:"button",onClick:b,style:{padding:"4px 8px",fontFamily:"monospace",letterSpacing:2,cursor:"pointer",whiteSpace:"nowrap"},title:"点击更换验证码",children:p})]})]}),(0,r.jsx)("button",{type:"submit",disabled:y,children:y?"登录中...":"登录"}),m&&(0,r.jsx)("p",{style:{color:"red"},children:m}),S&&(0,r.jsx)("p",{style:{color:"green"},children:S})]}),(0,r.jsxs)("p",{style:{marginTop:16},children:["还没有账号？ ",(0,r.jsx)(s.default,{href:"/register",children:"去注册"})]}),(0,r.jsxs)("p",{style:{marginTop:8,fontSize:14},children:["忘记密码？ ",(0,r.jsx)(s.default,{href:"/forgot-password",children:"通过邮箱重置"})]})]})}},7668:function(e,t,n){"use strict";function r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4,t="ABCDEFGHJKLMNPQRSTUVWXYZabcdefghjkmnpqrstuvwxyz0123456789",n="";for(let r=0;r<e;r++){let e=Math.floor(Math.random()*t.length);n+=t[e]}return n}n.d(t,{y:function(){return r}})},7138:function(e,t,n){"use strict";n.d(t,{default:function(){return a.a}});var r=n(231),a=n.n(r)},6463:function(e,t,n){"use strict";var r=n(1169);n.o(r,"usePathname")&&n.d(t,{usePathname:function(){return r.usePathname}}),n.o(r,"useRouter")&&n.d(t,{useRouter:function(){return r.useRouter}}),n.o(r,"useSearchParams")&&n.d(t,{useSearchParams:function(){return r.useSearchParams}})}},function(e){e.O(0,[231,971,23,744],function(){return e(e.s=9580)}),_N_E=e.O()}]);