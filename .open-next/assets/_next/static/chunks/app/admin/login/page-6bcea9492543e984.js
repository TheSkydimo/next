(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[920],{7272:function(e,t,n){Promise.resolve().then(n.bind(n,4507))},4507:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var a=n(7437),r=n(2265),s=n(7648),u=n(9376);function i(){let e=(0,u.useRouter)(),[t,n]=(0,r.useState)(""),[i,l]=(0,r.useState)(""),[o,d]=(0,r.useState)(!1),[c,h]=(0,r.useState)(null);async function p(n){n.preventDefault(),h(null),d(!0);try{let n=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:i})}),r=await n.json().catch(()=>({code:"UNKNOWN"}));if(!n.ok||"OK"!==r.code||!r.data){var a;h(null!==(a=r.message)&&void 0!==a?a:"登录失败");return}if("ADMIN"!==r.data.role){h("该账号不是管理员账号");return}e.push("/admin/plans")}catch(e){h("网络错误，请稍后重试")}finally{d(!1)}}return(0,a.jsxs)("main",{style:{maxWidth:400,margin:"40px auto",padding:"0 16px"},children:[(0,a.jsx)("h1",{children:"管理员登录"}),(0,a.jsxs)("form",{onSubmit:p,style:{display:"grid",gap:12,marginTop:16},children:[(0,a.jsxs)("label",{style:{display:"grid",gap:4},children:[(0,a.jsx)("span",{children:"管理员邮箱"}),(0,a.jsx)("input",{type:"email",value:t,onChange:e=>n(e.target.value),required:!0})]}),(0,a.jsxs)("label",{style:{display:"grid",gap:4},children:[(0,a.jsx)("span",{children:"密码"}),(0,a.jsx)("input",{type:"password",value:i,onChange:e=>l(e.target.value),required:!0})]}),(0,a.jsx)("button",{type:"submit",disabled:o,children:o?"登录中...":"登录后台"}),c&&(0,a.jsx)("p",{style:{color:"red"},children:c})]}),(0,a.jsxs)("p",{style:{marginTop:16,fontSize:14},children:["忘记密码？ ",(0,a.jsx)(s.default,{href:"/admin/forgot-password",children:"通过邮箱重置"})]})]})}},7648:function(e,t,n){"use strict";n.d(t,{default:function(){return r.a}});var a=n(2972),r=n.n(a)},9376:function(e,t,n){"use strict";var a=n(5475);n.o(a,"usePathname")&&n.d(t,{usePathname:function(){return a.usePathname}}),n.o(a,"useRouter")&&n.d(t,{useRouter:function(){return a.useRouter}}),n.o(a,"useSearchParams")&&n.d(t,{useSearchParams:function(){return a.useSearchParams}})}},function(e){e.O(0,[972,971,117,744],function(){return e(e.s=7272)}),_N_E=e.O()}]);